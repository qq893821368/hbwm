<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>修改信息</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <link rel="stylesheet" href="layui/css/layui.css" media="all">
    <link rel="stylesheet" href="layuiadmin/style/admin.css" media="all">
    <link rel="stylesheet" href="layuiadmin/style/login.css" media="all">
    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <script src="https://www.layuicdn.com/layui-v2.5.4/layui.all.js"></script>
</head>
<body>
<!--<a th:replace="fragments/modifySelf::body"></a>-->
<form method="post" action="/modifyInfo" style="width: 600px;height: 800px;margin-left: 30%;">
    <div class="layui-card-body" pad15="">

        <div class="layui-form" lay-filter="">
            <div class="layui-form-item">
                <label class="layui-form-label">用户 </label>
                <div th:if="${user.isVip()} eq false">
                    <div class="layui-input-inline">
                        <input type="text" name="userType" th:if="${user.account} eq 'admin'" value="管理员" readyonly class="layui-input">
                        <input type="text" name="userType" th:if="${user.account} ne 'admin'" value="普通用户" readonly class="layui-input">
                    </div>
                    <div class="layui-form-mid layui-word-aux"><a href="/beVIP?content=VIP升级">升级VIP?</a></div>
                </div>
                <div th:if="${user.isVip()} eq true">
                    <div class="layui-input-inline">
                        <input type="text" name="userType" th:if="${user.account} eq 'admin'" value="管理员" readyonly class="layui-input">
                        <input type="text" name="userType" th:if="${user.account} ne 'admin'" value="VIP用户" readonly class="layui-input">
                    </div>
                    <div class="layui-form-mid layui-word-aux"><a href="/beVIP?content=VIP续费">续费VIP?到期时间：<span
                            th:text="${vip.end_time}"></span></a></div>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">用户名</label>
                <div class="layui-input-inline">
                    <input type="text" name="userName" th:value="${user.account}" readonly class="layui-input">
                </div>
                <div class="layui-form-mid layui-word-aux">不可修改</div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">性别</label>
                <div class="layui-input-block">
                    <input type="radio" name="sex" value="男" title="男" th:if="${userInfo.gender} eq '男'" checked="">
                    <input type="radio" name="sex" value="男" title="男" th:if="${userInfo.gender} eq '女'">
                    <input type="radio" name="sex" value="女" title="女" th:if="${userInfo.gender} eq '女'" checked="">
                    <input type="radio" name="sex" value="女" title="女" th:if="${userInfo.gender} eq '男'">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">生日</label>
                <div class="layui-input-inline">
                    <input type="text" th:value="${userInfo.birthday}" class="layui-input" id="time1" name="birthday">
                </div>
            </div>

            <div class="layui-form-item">
                <label class="layui-form-label">地址</label>
                <div class="layui-input-inline">
                    <input type="text" name="address" th:value="${userInfo.address}" lay-verify="phone"
                           autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">邮箱</label>
                <div class="layui-input-inline">
                    <input type="text" name="email" th:value="${userInfo.email}" lay-verify="email" autocomplete="off"
                           class="layui-input">
                </div>
            </div>
            <div class="layui-form-item layui-form-text">
                <label class="layui-form-label">简介</label>
                <div class="layui-input-block" style="margin-left: 80px;">
                    <textarea name="intro" th:text="${userInfo.intro}" class="layui-textarea"></textarea>
                </div>
            </div>
            <div class="layui-form-item">
                <div class="layui-input-block" style="margin-left: 80px;">
                    <button class="layui-btn" type="submit" lay-filter="setmyinfo" id="LAY_upload">确认修改</button>
                    <button type="reset" class="layui-btn layui-btn-primary">重新填写</button>
                    <a href="/home" class="layui-btn">返回</a>
                </div>
            </div>
        </div>
    </div>
</form>
<input hidden id="msg" th:value="${message}"/>
<script>
    layui.use('laydate', function () {
        var laydate = layui.laydate;
        //执行一个laydate实例
        laydate.render({
            elem: document.getElementById('time1') //指定元素
        });

        layui.use('upload', function () {
            var upload = layui.upload;
            //执行一个上传用例
            upload.render({
                elem: '#LAY_avatarUpload'
                , url: '/upload'
                //,bindAction: '#LAY_upload' //指向一个按钮触发上传
                , done: function (res, index, upload) { //上传后的回调
                    location.reload();
                }
                //,accept: 'file' //允许上传的文件类型
                //,size: 50 //最大允许上传的文件大小
                //,……
            });
        });

        layui.use('form', function () {
            var form = layui.form; //只有执行了这一步，部分表单元素才会自动修饰成功

            //……

            //但是，如果你的HTML是动态生成的，自动渲染就会失效
            //因此你需要在相应的地方，执行下述方法来进行渲染
            form.render();
        });
    });

    layui.use('layer', function () {
        var layer = layui.layer;

        var m = $("#msg").val();
        if (m == "修改成功") {
            layer.msg(m, {
                icon: 1,
                time: 2000 //2秒关闭（如果不配置，默认是3秒）
            }, function () {
                location.href="http://localhost/home";
            });
        }
        if (m == "修改失败") {
            layer.msg(m, {
                icon: 2,
                time: 2000 //2秒关闭（如果不配置，默认是3秒）
            }, function () {
                //do something
            });
        }
        $("#msg").val("null");

    });

    //注意：导航 依赖 element 模块，否则无法进行功能性操作
    layui.use('element', function () {
        var element = layui.element;

        //…
    });

</script>
</body>
</html>